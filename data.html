<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Preparing the data &mdash; Documentation CDTK Documentation 0.1</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/cdtk.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="3. Submitting data to the DDR" href="submit.html" />
    <link rel="prev" title="1. System overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CDTK Documentation
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. System overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Preparing the data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data">2.1. Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vector-data">2.1.1. Vector data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#raster-data">2.1.2. Raster data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#qgis-project">2.2. QGIS Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converting-from-esri-mxd-file">2.2.1. Converting from ESRI MXD file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#map-and-data-projection">2.2.2. Map and data projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-properties">2.2.3. Project properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layer-properties">2.2.4. Layer properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#downloads">2.3. Downloads</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="submit.html">3. Submitting data to the DDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="use.html">4. Using the results</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CDTK Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">2. Preparing the data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/data.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="preparing-the-data">
<h1>2. Preparing the data<a class="headerlink" href="#preparing-the-data" title="Lien permanent vers cette rubrique"></a></h1>
<section id="data">
<h2>2.1. Data<a class="headerlink" href="#data" title="Lien permanent vers cette rubrique"></a></h2>
<p>The user of the CDTK can use the Data Dissemination Repository (DDR) to publish web services, downloadable files and Clip-Zip-Ship collections. The DDR support most GIS data formats, but there is some minimum settings required to make the publication workflow work.</p>
<section id="vector-data">
<h3>2.1.1. Vector data<a class="headerlink" href="#vector-data" title="Lien permanent vers cette rubrique"></a></h3>
<p>All vector data is stored in a PostGIS database on the DDR servers. The input data must be contained in a OGC Geopackage (GPKG) to be ingested by the DDR. If the user is using the DDR QGIS plugin to publish the data (see section  <a class="reference internal" href="submit.html#qgis-plugin-ref"><span class="std std-ref">3.2. Using the QGIS Plugin</span></a>), then the vector layers will be automatically converted to a GPKG no matter the source format. If the user chooses the input package method (see section <a class="reference internal" href="submit.html#directory-watcher-ref"><span class="std std-ref">3.3. Using the directory watcher</span></a>), the source of the vector layers has to be stored in a GPKG included in the package.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Using the QGIS plugin method</strong>: Any vector format supported.</p></li>
<li><p><strong>Using the input package method</strong>: All vector sources are stored in a GPKG.</p></li>
</ul>
</div></blockquote>
<p><strong>IMPORTANT:</strong> No matter the input format, the corresponding layers in both languages projects must have a common source containing both English and French attributes.</p>
</section>
<section id="raster-data">
<h3>2.1.2. Raster data<a class="headerlink" href="#raster-data" title="Lien permanent vers cette rubrique"></a></h3>
<p>Any type of raster data is supported be the DDR. The data has to by stored on a web server accessible to the DDR. If the web services created are accessible publicly, the raster needs to be hosted on a public server as well. The data is not copied to the DDR servers, it remains in its original location and the web service produced calls and displays the data from its source. If the data source is not available, then the raster layer in the web service will fail to load.</p>
</section>
</section>
<section id="qgis-project">
<h2>2.2. QGIS Project<a class="headerlink" href="#qgis-project" title="Lien permanent vers cette rubrique"></a></h2>
<p>In order to publish web services with the DDR, the user needs to create one QGIS project file for each official language. The only format supported is « .qgs », « .qgz » is <strong>not supported</strong>. The projects have to be named with the following naming convention:</p>
<blockquote>
<div><ul class="simple">
<li><p>Project file names are in lower case.</p></li>
<li><p>The first character of the project file name must be a letter.</p></li>
<li><p>Only unaccented alphanumeric characters and underscores are allowed.</p></li>
<li><p>The English project file name ends with <strong>« _en »</strong>.</p></li>
<li><p>The French project file name ends with <strong>« _fr »</strong>.</p></li>
<li><p>The basenames of both projects are identical (i.e.: major_projects_en and major_projects_fr).</p></li>
<li><p>The user should not publish two projects named with the same first 15 characters (i.e.: <strong>major_projects_</strong>inventory_en and <strong>major_projects_</strong>index_en).</p></li>
</ul>
</div></blockquote>
<section id="converting-from-esri-mxd-file">
<h3>2.2.1. Converting from ESRI MXD file<a class="headerlink" href="#converting-from-esri-mxd-file" title="Lien permanent vers cette rubrique"></a></h3>
<p>À remplir</p>
</section>
<section id="map-and-data-projection">
<span id="map-projection-ref"></span><h3>2.2.2. Map and data projection<a class="headerlink" href="#map-and-data-projection" title="Lien permanent vers cette rubrique"></a></h3>
<p>The DDR only support the 6 Coordinate Reference Systems (CRS) below. All the layers need to have the same CRS than the project.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EPSG</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3857</p></td>
<td><p>WGS 84 / Pseudo-Mercator (Google Maps, ESRI)</p></td>
</tr>
<tr class="row-odd"><td><p>3978</p></td>
<td><p>NAD83 / Canada Atlas Lambert</p></td>
</tr>
<tr class="row-even"><td><p>3979</p></td>
<td><p>NAD83(CSRS) / Canada Atlas Lambert</p></td>
</tr>
<tr class="row-odd"><td><p>4269</p></td>
<td><p>NAD83</p></td>
</tr>
<tr class="row-even"><td><p>4326</p></td>
<td><p>WGS84 - World Geodetic System 1984</p></td>
</tr>
<tr class="row-odd"><td><p>4617</p></td>
<td><p>NAD83(CSRS)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="project-properties">
<h3>2.2.3. Project properties<a class="headerlink" href="#project-properties" title="Lien permanent vers cette rubrique"></a></h3>
<p>Each project should be built with care by filling some mandatory and suggested information. Mandatory information is required to make a successful publication, while the suggested information will increase the user experience and the discoverability of your dataset.</p>
<ul>
<li><p>Mandatory:</p>
<blockquote>
<div><ul class="simple">
<li><p>In the « General » tab, set « Save paths » to « Relative ».</p></li>
</ul>
<img alt="_images/project_properties_relative_path.png" src="_images/project_properties_relative_path.png" />
<ul class="simple">
<li><p>In the « CRS » tab, choose a projection listed in the <a class="reference internal" href="#map-projection-ref"><span class="std std-ref">2.2.2. Map and data projection</span></a> section and make sure that all the layers use the same CRS.</p></li>
</ul>
<img alt="_images/crs_selection.png" src="_images/crs_selection.png" />
</div></blockquote>
</li>
<li><p>Suggested:</p>
<blockquote>
<div><ul>
<li><p>In the « Metadata » tab, as much information as possible about the project should be provided, particularly:</p>
<blockquote>
<div><ul class="simple">
<li><p>Title</p></li>
<li><p>Author</p></li>
<li><p>Abstract</p></li>
<li><p>ISO Categories</p></li>
<li><p>Keywords</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="layer-properties">
<h3>2.2.4. Layer properties<a class="headerlink" href="#layer-properties" title="Lien permanent vers cette rubrique"></a></h3>
<p>As for the project properties, each layer has to be configured individually with care. If the service is published to the Clip-Zip-Ship (see <a class="reference internal" href="overview.html#czs-ref"><span class="std std-ref">1.3. Clip-Zip-Ship</span></a> section), only the metadata filled in the layer properties will appear in the CZS as each layer will create an individual collection.</p>
<ul>
<li><p>Mandatory:</p>
<blockquote>
<div><ul class="simple">
<li><p>In the « QGIS Server » tab, each layer must have a unique short name.</p></li>
</ul>
<img alt="_images/layer_short_name.png" src="_images/layer_short_name.png" />
<ul class="simple">
<li><p>The corresponding layer in the other language’s project must have the exact <strong>same short name</strong>.</p></li>
<li><p>There is no need to fill the other fields in that tab as any information inputed in the « Metadata » will be automatically copied over to the « QGIS Server » tab by the DDR process.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Suggested:</p>
<blockquote>
<div><ul>
<li><p>In the « Metadata » tab, as much information as possible about the layer should be provided, particularly:</p>
<blockquote>
<div><ul class="simple">
<li><p>Title</p></li>
<li><p>Author</p></li>
<li><p>Abstract</p></li>
<li><p>ISO Categories</p></li>
<li><p>Keywords</p></li>
</ul>
</div></blockquote>
</li>
<li><p>In the « Fields » tab, it is possible to hide some fields from the GetFeatureInfo response in the web service. By example, French attributes can be hidden in the English project and vice-versa.</p></li>
</ul>
<img alt="_images/fields.png" src="_images/fields.png" />
<ul class="simple">
<li><p>To enhance user experience, field aliases should be set in the « Attributes Form » tab.</p></li>
</ul>
<img alt="_images/aliases.png" src="_images/aliases.png" />
<ul class="simple">
<li><p>If the layer is time-enabled, please fill the necessary information in the « Temporal » tab.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="downloads">
<h2>2.3. Downloads<a class="headerlink" href="#downloads" title="Lien permanent vers cette rubrique"></a></h2>
<p>The CDTK includes a public FTP distribution site where the user can make files available for download. The process of uploading these files is integrated to the DDR publication mecanism.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Create a distinct folder containing all the files and subfolders to be stored on the FTP site.</p></li>
<li><p>Compress this folder into a .zip file (other extensions not supported).</p></li>
</ol>
</div></blockquote>
<p>The download package is now ready to be joined to the publication (see <a class="reference internal" href="submit.html#submit-ref"><span class="std std-ref">3. Submitting data to the DDR</span></a> section).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="overview.html" class="btn btn-neutral float-left" title="1. System overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="submit.html" class="btn btn-neutral float-right" title="3. Submitting data to the DDR" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Natural resources Canada, Her Majesty the King in right of Canada.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>